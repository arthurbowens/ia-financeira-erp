<div class="dashboard-container">
  <div class="header">
    <h1>📊 Dashboard Financeiro</h1>
    <div class="last-update">
      Última atualização: {{ currentDate | date:'dd/MM/yyyy HH:mm' }}
    </div>
  </div>

  <div class="stats-grid">
    <div class="stat-card receita">
      <div class="stat-icon">💰</div>
      <div class="stat-content">
        <div class="stat-value">{{ formatCurrency(dados.receitas) }}</div>
        <div class="stat-label">Receitas</div>
      </div>
    </div>

    <div class="stat-card despesas">
      <div class="stat-icon">💸</div>
      <div class="stat-content">
        <div class="stat-value">{{ formatCurrency(dados.despesas) }}</div>
        <div class="stat-label">Despesas</div>
      </div>
    </div>

    <div class="stat-card lucro" [ngClass]="getStatusClass()">
      <div class="stat-icon">📈</div>
      <div class="stat-content">
        <div class="stat-value">{{ formatCurrency(dados.lucro) }}</div>
        <div class="stat-label">Lucro</div>
        <div class="stat-percentage">{{ getMargemLucro() }}</div>
      </div>
    </div>

    <div class="stat-card contratos">
      <div class="stat-icon">📋</div>
      <div class="stat-content">
        <div class="stat-value">{{ dados.contratosAtivos }}</div>
        <div class="stat-label">Contratos Ativos</div>
        <div class="stat-sub">{{ dados.contratosPendentes }} pendentes</div>
      </div>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-container">
      <div class="chart-header">
        <h3>📈 Receita Mensal</h3>
        <div class="chart-actions">
          <button class="chart-btn" (click)="criarGraficoReceitas()">🔄</button>
        </div>
      </div>
      <div class="chart-wrapper">
        <canvas id="receitaChart"></canvas>
      </div>
    </div>

    <div class="chart-container">
      <div class="chart-header">
        <h3>🥧 Despesas por Categoria</h3>
        <div class="chart-actions">
          <button class="chart-btn" (click)="criarGraficoDespesas()">🔄</button>
        </div>
      </div>
      <div class="chart-wrapper">
        <canvas id="despesasChart"></canvas>
      </div>
    </div>
  </div>

  <div class="ai-analysis-section">
    <div class="analysis-header">
      <h3>🤖 Análise Inteligente da IA</h3>
      <button class="refresh-btn" (click)="analisarDadosFinanceiros()" [disabled]="isAnalisando">
        {{ isAnalisando ? '⏳' : '🔄' }}
      </button>
    </div>
    
    <div class="analysis-content">
      <div *ngIf="isAnalisando" class="loading-state">
        <div class="loading-spinner"></div>
        <p>Analisando dados financeiros com IA...</p>
      </div>
      
      <div *ngIf="analiseIA && !isAnalisando" class="analysis-text">
        <p>{{ analiseIA }}</p>
      </div>
    </div>
  </div>

  <div class="quick-actions">
    <h3>⚡ Ações Rápidas</h3>
    <div class="actions-grid">
      <a class="action-card" routerLink="/contratos">
        <div class="action-icon">📋</div>
        <div class="action-text">Gerenciar Contratos</div>
      </a>
      
      <a class="action-card" routerLink="/chat">
        <div class="action-icon">💬</div>
        <div class="action-text">Chat com IA</div>
      </a>
      
      <button class="action-card" (click)="analisarDadosFinanceiros()">
        <div class="action-icon">🔍</div>
        <div class="action-text">Análise Detalhada</div>
      </button>
    </div>
  </div>
</div>
